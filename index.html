<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="controller.js"></script>
  </head>


  <body>
    <script type="text/javascript">
      AFRAME.registerComponent('drag-rotate-component',{
        schema : { speed : {default:1}},
        init : function(){
          this.ifMouseDown = false;
          this.x_cord = 0;
          this.y_cord = 0;
          document.addEventListener('mousedown',this.OnDocumentMouseDown.bind(this));
          document.addEventListener('mouseup',this.OnDocumentMouseUp.bind(this));
          document.addEventListener('mousemove',this.OnDocumentMouseMove.bind(this));
        },
        OnDocumentMouseDown : function(event){
          this.ifMouseDown = true;
          this.x_cord = event.clientX;
          this.y_cord = event.clientY;
        },
        OnDocumentMouseUp : function(){
          this.ifMouseDown = false;
        },
        OnDocumentMouseMove : function(event)
        {
          if(this.ifMouseDown)
          {
            var temp_x = event.clientX-this.x_cord;
            var temp_y = event.clientY-this.y_cord;
            if(Math.abs(temp_y)<Math.abs(temp_x))
            {
              this.el.object3D.rotateY(temp_x*this.data.speed/1000);
            }
            else
            {
              this.el.object3D.rotateX(temp_y*this.data.speed/1000);
            }
            this.x_cord = event.clientX;
            this.y_cord = event.clientY;
          }
        }
      });
    </script>
    
    <a-scene>


        <a-assets>
            <a-asset-item id="friend-ply" src="example_mesh_0.ply"></a-asset-item>
            <a-asset-item id="friend-obj" src="example_mesh_0.obj"></a-asset-item>

            <!-- <a-asset-item id="friend-o" src="https://graphics.stanford.edu/courses/cs148-10-summer/as3/code/as3/teapot.obj"></a-asset-item> -->
        </a-assets>
    

      <a-plane rotation="-90 0 0" color="purple" height="10" width="10" ></a-plane>
      <a-sky color="blue"></a-sky>
      <a-entity id="player">
        <a-camera id="head" wasd-controls look-controls></a-camera>
        <a-entity id="leftHand" hand-controls="hand: left" smooth-locomotion="active: true"></a-entity>
        <a-entity id="rightHand" hand-controls="hand: right"></a-entity>
      </a-entity>
      <a-entity obj-model="obj: #friend-obj; material: #friend-ply"
        position = "0 2 3"
        scale="1 1 1"
        
      >
      </a-entity>

      <a-entity obj-model="obj: #friend-obj; material: #friend-ply"
        position = "1 1 1"
        scale="0.5 0.5 0.5"
        rotation="90 200 180">
        
      >
      </a-entity>


    </a-scene>
  </body>
</html>